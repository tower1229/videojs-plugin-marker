(function(r,a){typeof exports=="object"&&typeof module!="undefined"?module.exports=a(require("video.js")):typeof define=="function"&&define.amd?define(["video.js"],a):(r=typeof globalThis!="undefined"?globalThis:r||self,r.lib=a(r.videojs$1))})(this,function(r){"use strict";function a(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var s=a(r);const p=s.default.getComponent("Component"),c=s.default.getComponent("TimeTooltip");class f extends p{constructor(e,t){super(e,t),this.options=t,this.timeToltip=new c(e),this.timeToltip.hide(),this.addChild(this.timeToltip),this.addClass("vjs-marker-point-tip"),this.timeToltip.el_.innerHTML=`
      <p class="vjs-marker-point-tip-time">${s.default.formatTime(this.options.offset,600)}</p>
      <p class="vjs-marker-point-tip-content">${this.options.data?this.options.data.content:""}</p>
    `}updatePosition(){this.timeToltip.el_.style.left=`-${this.timeToltip.el_.getBoundingClientRect().width/2}px`}}class k extends p{constructor(e,t){super(e,t),this.offset=t.offset,this.data=t.data,this.tip=new f(e,{data:this.data,offset:this.offset}),this.mouseDisplay=e.getDescendant(["ControlBar","ProgressControl","SeekBar","MouseTimeDisplay"]),this.addChild(this.tip),this.enableTouchActivity(),this.on("mouseenter",i=>{this.mouseDisplay.hide(),this.tip.timeToltip.show(),this.tip.updatePosition()}),this.on("mouseleave",i=>{this.mouseDisplay.show(),this.tip.timeToltip.hide()}),this.on("mousedown",i=>{typeof t.onClick=="function"&&t.onClick(i)})}createEl(){return s.default.dom.createEl("div",{className:"vjs-marker-point"})}updatePosition(e){this.el_&&(this.el_.style.left=this.offset/e*100+"%")}}const g=s.default.getComponent("Component");let h;class l extends g{static build(e,t){t.markers instanceof Array||(t.markers=[]);const i=[];for(let d=t.markers.length;d--;)i.push(new k(e,t.markers[d]));return new l(e,{markers:i,barName:"markerPoint"})}constructor(e,t){super(e,t),t.markers.forEach(m=>this.addChild(m));const i=()=>{t.markers.forEach(m=>{m.updatePosition(h)})},d=()=>{h=e.duration(),i(),e.off("loadedmetadata",d)};h?i():e.on("loadedmetadata",d)}createEl(){return s.default.dom.createEl("div",{className:"vjs-marker-bar"})}}s.default.registerComponent("MarkerBar",l);const v="0.0.8";var j="";let n;window.videojs?(n=window.videojs,console.warn("MarkerPlugin: \u68C0\u6D4B\u5230window.videojs")):n=s.default;const C=n.getPlugin("plugin"),T={};class u extends C{constructor(e,t){super(e),this.player.addClass("vjs-marker-plugin"),this.updateOptions(t)}createMarkerBar(){return this.markerBar=l.build(this.player,{markers:this.options.markers}),this.markerBar}updateOptions(e){this.options=n.mergeOptions(T,e),this.markerBar&&this.markerBar.dispose();const t=this.player.getDescendant(["ControlBar","ProgressControl","SeekBar"]);this.createMarkerBar(),t.addChild(this.markerBar)}}return u.defaultState={},u.VERSION=v,n.registerPlugin("markerPlugin",u),u});
